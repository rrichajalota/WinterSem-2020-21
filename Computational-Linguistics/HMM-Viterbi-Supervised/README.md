## POS-tagger using Hidden Markov Models and Viterbi Algorithm

### About
 
In this code repo, a bigram part-of-speech tagger has been implemented using [Hidden Markov Model (HMM) and Viterbi Algorithm](https://web.stanford.edu/~jurafsky/slp3/A.pdf).
HMM is used during training to learn (with supervision) the Initial, Transition and Emission probability matrices from the given (annotated) training data. 
Viterbi algorithm is then used to tag an un-annotated corpus with POS-labels. A crude-smoothing approach is used to tackle previously unseen words. 

### Project file structure

```
├── helper.py
├── assignment2.ipynb
├── viterbi.py
├── HMM_training.py
├── eval.py
├── main.py
├── de-utb
│   ├── de-eval.tt
│   ├── de-test.t
│   └── de-train.tt
├── outputs
│   ├── de-tagged.tt
│   ├── speed_sentence_length_plot.pdf
│   └── 

```
`helper.py` contains I/O or other utility functions.  
`assignment2.ipynb` contains preliminary code (only meant for playing around).  
`viterbi.py` contains the implementation of Viterbi Algorithm with a crude-smoothing to handle unknown words.
`HMM_training.py` contains functions to train the HMM.  
`eval.py` will be used to evaluate the gold dataset against the tagger-output. Check out [How to run the scripts?](#how-to-run-the-scripts?).    
`main.py` is the controller file that runs the entire pipeline. Check out [How to run the scripts?](#how-to-run-the-scripts?).   
`de-utb/` is the given data folder.   
`outputs/` In this folder, all the data files generated by the code are stored.   

### Setup Instructions

The code was implemented and tested on: `Python 3.6.9, Ubuntu 18.04`.

Use the following command, preferably in a virtual environment, to run the scripts.  
  ```
  pip -r install requirements.txt
  ```
Or, simply make sure the following libraries are installed:

- matplotlib==3.3.3
- nltk==3.5
- numpy==1.19.4

### How to run the scripts?

#### For training and predicting the POS-tags 
- in the default setting (i.e. with crude-smoothing and default filepaths)  -
Simply, run `python main.py` and a tagged-output file will be generated at:  `outputs/de-tagged.tt`.  
The output file, `outputs/de-tagged.tt`, will be in the CONLL format with test words in the first column and POS-tags in the second. 

- Additional arguments that can be passed, are listed below: 
   ```
  --train [FILENAME]  # use this option to provide a file (in CONLL format with words and POS-tags as columns) for training HMM
  --test [FILENAME]   # use this option to provide a file (in CONLL format with words and POS-tags as columns) for testing the tagger
  --plot_speed_curve  # If specified, speed vs sentence-length curve is returned.
  --tagged_file_path [FILENAME]  # provide filename or filepath for saving the (POS-)tagged output file
  --help  # to get a preview of the available commands
   ```

#### For Evaluation of the Tagger  
  Use the evaluation script provided as follows:
  ```
  python eval.py de-utb/de-eval.tt outputs/de-tagged.tt
  ```

### Runtime

```
Runtime (training HMM): 1.79 secs
Runtime (viterbi) on 1000 sentences of test set: 5.52 secs
```


